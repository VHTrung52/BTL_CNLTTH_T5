{"remainingRequest":"D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\babel-loader\\lib\\index.js!D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\ts-loader\\index.js??ref--13-2!D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\src\\components\\HoaDon\\ThemSuaHoaDon.vue?vue&type=script&lang=ts&","dependencies":[{"path":"D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\src\\components\\HoaDon\\ThemSuaHoaDon.vue","mtime":1603960010000},{"path":"D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\.babelrc","mtime":1603960008000},{"path":"D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1605537925844},{"path":"D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1605537925844},{"path":"D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.search\";\nimport \"core-js/modules/es6.object.assign\";\nimport { Vue } from 'vue-property-decorator';\nimport HoaDonApi from '@/apiResources/HoaDonApi';\nimport DatDichVuApi from '@/apiResources/DatDichVuApi';\nimport ThuePhongApi from '@/apiResources/ThuePhongApi';\nimport KhachHangApi from '@/apiResources/KhachHangApi';\nimport DichVuApi from '@/apiResources/DichVuApi';\nimport PhongApi from '@/apiResources/PhongApi';\nimport BangGiaApi from '@/apiResources/BangGiaApi';\nimport LoaiPhongApi from '@/apiResources/LoaiPhongApi';\nimport store from '@/store/store';\nexport default Vue.extend({\n  $_veeValidate: {\n    validator: 'new'\n  },\n  components: {},\n  data: function data() {\n    return {\n      dialogThongBao: false,\n      daTonTai: null,\n      isUpdate: false,\n      bangGia: {},\n      hoaDon: {},\n      khachHang: {},\n      datDichVu: {},\n      thuePhong: {},\n      dsDichVu: [],\n      dsPhong: [],\n      dsLoaiPhong: [],\n      searchDichVu: '',\n      searchPhong: '',\n      searchLoaiPhong: '',\n      searchParamsDichVu: {\n        includeEntities: true\n      },\n      searchParamsLoaiPhong: {\n        includeEntities: true\n      },\n      searchParamsPhong: {\n        includeEntities: true\n      },\n      dsDatDichVu: [],\n      dsDatDichVuLoading: false,\n      searchDatDichVu: '',\n      searchParamsDatDichVu: {\n        includeEntities: true\n      },\n      tableHeaderDatDichVu: [{\n        text: '#',\n        value: 'DatDichVuID',\n        align: 'center',\n        sortable: true\n      }, {\n        text: 'Tên dịch vụ',\n        value: 'SoLuong',\n        align: 'center',\n        sortable: true\n      }, {\n        text: 'Số lượng đặt',\n        value: 'DichVuID',\n        align: 'center',\n        sortable: true\n      }, {\n        text: 'Giá bán',\n        value: 'HoaDonID',\n        align: 'center',\n        sortable: true\n      }, {\n        text: 'Mô tả',\n        value: 'HoaDonID',\n        align: 'center',\n        sortable: true\n      }, {\n        text: 'Thao tác',\n        value: 'HoaDonID',\n        align: 'center',\n        sortable: true\n      }],\n      dsThuePhong: [],\n      dsThuePhongLoading: false,\n      searchThuePhong: '',\n      searchParamsThuePhong: {\n        includeEntities: true\n      },\n      tableHeaderThuePhong: [{\n        text: '#',\n        value: 'ThuePhongID',\n        align: 'center',\n        sortable: true\n      }, {\n        text: 'Số phòng',\n        value: 'PhongID',\n        align: 'center',\n        sortable: true\n      }, {\n        text: 'Loại phòng',\n        value: 'HoaDonID',\n        align: 'center',\n        sortable: true\n      }, {\n        text: 'Giá phòng',\n        value: 'HoaDonID',\n        align: 'center',\n        sortable: true\n      }, {\n        text: 'Thao tác',\n        value: 'HoaDonID',\n        align: 'center',\n        sortable: true\n      }],\n      loading: false,\n      searchParamsHoaDon: {},\n      dialog: false,\n      selectedDatDichVu: {},\n      selectedThuePhong: {},\n      dialogConfirmDelete: false,\n      isUpdateDichVu: false,\n      dichVu: {}\n    };\n  },\n  methods: {\n    show: function show(isUpdate, item) {\n      this.dialog = true;\n      this.daTonTai = null;\n      this.$validator.errors.clear(\"frmAddEdit\");\n      this.hoaDon = Object.assign({}, item);\n      this.khachHang = {};\n      this.thuePhong = {};\n      this.datDichVu = {};\n      this.dsDatDichVu = [];\n      this.dsThuePhong = [];\n      this.getDSLoaiPhong();\n      this.getDSDichVu();\n      this.isUpdateDichVu = false;\n      this.isUpdate = isUpdate;\n\n      if (this.isUpdate !== true) {\n        this.hoaDon = {};\n      } else {\n        this.daTonTai = true;\n        this.getDataFromApi(this.hoaDon.HoaDonID);\n      }\n    },\n    xuLyThongTinKhachHang: function xuLyThongTinKhachHang() {\n      var _this = this;\n\n      if (this.daTonTai == null) {\n        KhachHangApi.kiemtra(this.khachHang.CMND).then(function (res) {\n          _this.dialogThongBao = true;\n          if (res == null) _this.daTonTai = false;else {\n            _this.daTonTai = true;\n            _this.khachHang = res;\n          }\n        });\n      }\n\n      if (this.daTonTai == false) {\n        KhachHangApi.insert(this.khachHang).then(function (res) {\n          _this.khachHang = res;\n\n          _this.$snotify.success('Thêm mới khách hàng thành công!');\n        }).catch(function (res) {\n          _this.$snotify.error('Thêm mới khách hàng thất bại!');\n        });\n      }\n\n      if (this.daTonTai == true) {\n        KhachHangApi.update(this.khachHang.KhachHangID, this.khachHang).then(function (res) {\n          _this.khachHang = res;\n\n          _this.$snotify.success('Cập nhật khách hàng thành công!');\n        }).catch(function (res) {\n          _this.$snotify.error('Cập nhật khách hàng thất bại!');\n        });\n      }\n    },\n    getDataFromApi: function getDataFromApi(id) {\n      var _this2 = this;\n\n      HoaDonApi.detail(id).then(function (res) {\n        _this2.hoaDon = res;\n        _this2.dsThuePhong = res.ThuePhong;\n        _this2.dsDatDichVu = res.DatDichVu;\n        _this2.khachHang = res.KhachHang;\n      });\n    },\n    getDSPhong: function getDSPhong() {\n      var _this3 = this;\n\n      this.searchParamsPhong.ngayNhanPhong = this.hoaDon.ThoiGianNhanPhong;\n      PhongApi.search(this.searchParamsPhong).then(function (res) {\n        _this3.getGiaApDung();\n\n        _this3.dsPhong = res.Data;\n      });\n    },\n    getDSLoaiPhong: function getDSLoaiPhong() {\n      var _this4 = this;\n\n      LoaiPhongApi.search(this.searchParamsLoaiPhong).then(function (res) {\n        _this4.dsLoaiPhong = res.Data;\n      });\n    },\n    getDSDichVu: function getDSDichVu() {\n      var _this5 = this;\n\n      DichVuApi.search(this.searchParamsDichVu).then(function (res) {\n        _this5.dsDichVu = res.Data;\n      });\n    },\n    getDichVu: function getDichVu() {\n      var _this6 = this;\n\n      DichVuApi.detail(this.datDichVu.DichVuID).then(function (res) {\n        _this6.dichVu = res;\n      });\n    },\n    getGiaApDung: function getGiaApDung() {\n      var _this7 = this;\n\n      var thoigian = this.$moment(this.hoaDon.ThoiGianNhanPhong).format(\"DD/MM/YYYY\");\n\n      if (this.searchParamsPhong.loaiPhongID != null && this.searchParamsPhong.loaiPhongID != undefined) {\n        BangGiaApi.giaapdung(thoigian, this.searchParamsPhong.loaiPhongID).then(function (res) {\n          _this7.bangGia = res;\n        });\n      }\n    },\n    getDSThuePhong: function getDSThuePhong() {\n      var _this8 = this;\n\n      this.searchParamsThuePhong.hoaDonID = this.hoaDon.HoaDonID;\n      ThuePhongApi.search(this.searchParamsThuePhong).then(function (res) {\n        _this8.dsThuePhong = res.Data;\n      });\n    },\n    getDSDatDichVu: function getDSDatDichVu() {\n      var _this9 = this;\n\n      this.searchParamsDatDichVu.hoaDonID = this.hoaDon.HoaDonID;\n      DatDichVuApi.search(this.searchParamsDatDichVu).then(function (res) {\n        _this9.dsDatDichVu = res.Data;\n      });\n    },\n    themSuaThuePhong: function themSuaThuePhong(isUpdate, item) {\n      var _this10 = this;\n\n      this.thuePhong.BangGiaID = this.bangGia.BangGiaID;\n      this.thuePhong.HoaDonID = this.hoaDon.HoaDonID;\n\n      if (isUpdate == true) {} else {\n        ThuePhongApi.insert(this.thuePhong).then(function (res) {\n          _this10.thuePhong = {};\n          _this10.searchParamsPhong.loaiPhongID = null;\n\n          _this10.getDSThuePhong();\n        });\n      }\n    },\n    themSuaDatDichVu: function themSuaDatDichVu(isUpdate, item) {\n      var _this11 = this;\n\n      this.datDichVu.HoaDonID = this.hoaDon.HoaDonID;\n\n      if (isUpdate == true) {\n        DatDichVuApi.detail(item.DatDichVuID).then(function (res) {\n          _this11.datDichVu = res;\n          _this11.isUpdateDichVu = true;\n        });\n      } else {\n        if (this.isUpdateDichVu == true) {\n          DatDichVuApi.update(this.datDichVu.DatDichVuID, this.datDichVu).then(function (res) {\n            _this11.datDichVu = {};\n            _this11.isUpdateDichVu = false;\n\n            _this11.getDSDatDichVu();\n\n            _this11.$snotify.success('Cập nhật thành công!');\n          }).catch(function (res) {\n            _this11.loading = false;\n\n            _this11.$snotify.error('Cập nhật thất bại!');\n          });\n        } else {\n          DatDichVuApi.insert(this.datDichVu).then(function (res) {\n            _this11.datDichVu = {};\n            _this11.isUpdateDichVu = false;\n\n            _this11.getDSDatDichVu();\n          });\n        }\n      }\n    },\n    confirmDelete: function confirmDelete(item1, item2) {\n      this.selectedThuePhong = item1;\n      this.selectedDatDichVu = item2;\n      this.dialogConfirmDelete = true;\n    },\n    deleteChiTietHoaDon: function deleteChiTietHoaDon() {\n      var _this12 = this;\n\n      if (this.selectedDatDichVu != null) {\n        DatDichVuApi.delete(this.selectedDatDichVu.DatDichVuID).then(function (res) {\n          _this12.$snotify.success('Xóa thành công!');\n\n          _this12.getDSDatDichVu();\n\n          _this12.dialogConfirmDelete = false;\n        }).catch(function (res) {\n          _this12.$snotify.error('Xóa thất bại!');\n        });\n      }\n\n      if (this.selectedThuePhong != null) {\n        ThuePhongApi.delete(this.selectedThuePhong.ThuePhongID).then(function (res) {\n          _this12.$snotify.success('Xóa thành công!');\n\n          _this12.getDSThuePhong();\n\n          _this12.dialogConfirmDelete = false;\n        }).catch(function (res) {\n          _this12.$snotify.error('Xóa thất bại!');\n        });\n      }\n    },\n    save: function save() {\n      var _this13 = this;\n\n      this.$validator.validateAll('frmAddEdit').then(function (res) {\n        if (res) {\n          _this13.hoaDon.DatPhong = undefined;\n          _this13.hoaDon.NhanVien = undefined;\n          _this13.hoaDon.KhachHang = undefined;\n          _this13.hoaDon.DatDichVu = undefined;\n          _this13.hoaDon.ThuePhong = undefined;\n\n          if (_this13.isUpdate) {\n            _this13.loading = true;\n            HoaDonApi.update(_this13.hoaDon.HoaDonID, _this13.hoaDon).then(function (res) {\n              _this13.loading = false;\n              _this13.dialog = false;\n\n              _this13.$emit(\"getLaiDanhSach\");\n\n              _this13.$snotify.success('Cập nhật thành công!');\n            }).catch(function (res) {\n              _this13.loading = false;\n\n              _this13.$snotify.error('Cập nhật thất bại!');\n            });\n          } else {\n            _this13.loading = true;\n            _this13.hoaDon.KhachHangID = _this13.khachHang.KhachHangID;\n            _this13.hoaDon.NhanVienID = store.state.user.Profile.NhanVien.NhanVienID;\n            HoaDonApi.insert(_this13.hoaDon).then(function (res) {\n              _this13.hoaDon = res;\n              _this13.isUpdate = true;\n              _this13.loading = false;\n\n              _this13.$emit(\"getLaiDanhSach\");\n\n              _this13.$snotify.success('Thêm mới thành công!');\n            }).catch(function (res) {\n              _this13.loading = false;\n\n              _this13.$snotify.error('Thêm mới thất bại!');\n            });\n          }\n        }\n      });\n    }\n  }\n});",{"version":3,"sources":["D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\src\\components\\HoaDon\\ThemSuaHoaDon.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Vue } from 'vue-property-decorator';\nimport HoaDonApi, { HoaDonApiSearchParams } from '@/apiResources/HoaDonApi';\nimport { HoaDon } from '@/models/HoaDon';\nimport { DatDichVu } from '@/models/DatDichVu';\nimport DatDichVuApi, { DatDichVuApiSearchParams } from '@/apiResources/DatDichVuApi';\nimport { ThuePhong } from '@/models/ThuePhong';\nimport ThuePhongApi, { ThuePhongApiSearchParams } from '@/apiResources/ThuePhongApi';\nimport { KhachHang } from '@/models/KhachHang';\nimport KhachHangApi, { KhachHangApiSearchParams } from '@/apiResources/KhachHangApi';\nimport DichVuApi, { DichVuApiSearchParams } from '@/apiResources/DichVuApi';\nimport PhongApi, { PhongApiSearchParams } from '@/apiResources/PhongApi';\nimport BangGiaApi, { BangGiaApiSearchParams } from '@/apiResources/BangGiaApi';\nimport LoaiPhongApi, { LoaiPhongApiSearchParams } from '@/apiResources/LoaiPhongApi';\nimport { Phong } from '@/models/Phong';\nimport { LoaiPhong } from '@/models/LoaiPhong';\nimport { DichVu } from '@/models/DichVu';\nimport { BangGia } from '@/models/BangGia';\nimport store from '@/store/store';\n\nexport default Vue.extend({\n    $_veeValidate: {\n        validator: 'new'\n    },\n    components: {},\n    data() {\n        return {\n            dialogThongBao: false,\n            daTonTai: null as any,\n            isUpdate: false,\n            bangGia: {} as BangGia,\n            hoaDon: {} as HoaDon,\n            khachHang: {} as KhachHang,\n            datDichVu: {} as DatDichVu,\n            thuePhong: {} as ThuePhong,\n            dsDichVu: [] as DichVu[],\n            dsPhong: [] as Phong[],\n            dsLoaiPhong: [] as LoaiPhong[],\n            searchDichVu: '',\n            searchPhong: '',\n            searchLoaiPhong: '',\n            searchParamsDichVu: { includeEntities: true } as DichVuApiSearchParams,\n            searchParamsLoaiPhong: { includeEntities: true } as LoaiPhongApiSearchParams,\n            searchParamsPhong: { includeEntities: true } as PhongApiSearchParams,\n            dsDatDichVu: [] as DatDichVu[],\n            dsDatDichVuLoading: false,\n            searchDatDichVu: '',\n            searchParamsDatDichVu: { includeEntities: true } as DatDichVuApiSearchParams,\n            tableHeaderDatDichVu: [\n                { text: '#', value: 'DatDichVuID', align: 'center', sortable: true },\n                { text: 'Tên dịch vụ', value: 'SoLuong', align: 'center', sortable: true },\n                { text: 'Số lượng đặt', value: 'DichVuID', align: 'center', sortable: true },\n                { text: 'Giá bán', value: 'HoaDonID', align: 'center', sortable: true },\n                { text: 'Mô tả', value: 'HoaDonID', align: 'center', sortable: true },\n                { text: 'Thao tác', value: 'HoaDonID', align: 'center', sortable: true },\n            ],\n            dsThuePhong: [] as ThuePhong[],\n            dsThuePhongLoading: false,\n            searchThuePhong: '',\n            searchParamsThuePhong: { includeEntities: true } as ThuePhongApiSearchParams,\n            tableHeaderThuePhong: [\n                { text: '#', value: 'ThuePhongID', align: 'center', sortable: true },\n                { text: 'Số phòng', value: 'PhongID', align: 'center', sortable: true },\n                { text: 'Loại phòng', value: 'HoaDonID', align: 'center', sortable: true },\n                { text: 'Giá phòng', value: 'HoaDonID', align: 'center', sortable: true },\n                { text: 'Thao tác', value: 'HoaDonID', align: 'center', sortable: true },\n            ],\n            loading: false,\n            searchParamsHoaDon: {} as HoaDonApiSearchParams,\n            dialog: false,\n            selectedDatDichVu: {} as DatDichVu,\n            selectedThuePhong: {} as ThuePhong,\n            dialogConfirmDelete: false,\n            isUpdateDichVu: false,\n            dichVu: {} as DichVu\n        }\n    },\n    methods: {\n        show(isUpdate: boolean, item: any) {\n            this.dialog = true;\n            this.daTonTai = null as any;\n            this.$validator.errors.clear(\"frmAddEdit\");\n            this.hoaDon = Object.assign({}, item);\n            this.khachHang = {} as KhachHang;\n            this.thuePhong = {} as ThuePhong;\n            this.datDichVu = {} as DatDichVu;\n            this.dsDatDichVu = [] as DatDichVu[];\n            this.dsThuePhong = [] as ThuePhong[];\n            this.getDSLoaiPhong();\n            this.getDSDichVu();\n            this.isUpdateDichVu = false;\n            this.isUpdate = isUpdate;\n            if (this.isUpdate !== true) {\n                this.hoaDon = {} as HoaDon;\n            }\n            else {\n                this.daTonTai = true;\n                this.getDataFromApi(this.hoaDon.HoaDonID);\n            }\n        },\n        xuLyThongTinKhachHang() {\n            if (this.daTonTai == null) {\n                KhachHangApi.kiemtra(this.khachHang.CMND).then(res => {\n                    this.dialogThongBao = true\n                    if (res == null)\n                        this.daTonTai = false\n                    else {\n                        this.daTonTai = true;\n                        this.khachHang = res;\n                    }\n                });\n            }\n            if (this.daTonTai == false) {\n                KhachHangApi.insert(this.khachHang).then(res => {\n                    this.khachHang = res;\n                    this.$snotify.success('Thêm mới khách hàng thành công!');\n                }).catch(res => {\n                    this.$snotify.error('Thêm mới khách hàng thất bại!');\n                })\n            }\n            if (this.daTonTai == true) {\n                KhachHangApi.update(this.khachHang.KhachHangID, this.khachHang).then(res => {\n                    this.khachHang = res;\n                    this.$snotify.success('Cập nhật khách hàng thành công!');\n                }).catch(res => {\n                    this.$snotify.error('Cập nhật khách hàng thất bại!');\n                })\n            }\n        },\n        getDataFromApi(id: number): void {\n            HoaDonApi.detail(id).then(res => {\n                this.hoaDon = res;\n                this.dsThuePhong = res.ThuePhong as any;\n                this.dsDatDichVu = res.DatDichVu as any;\n                this.khachHang = res.KhachHang as any;\n            });\n        },\n        getDSPhong(): void {\n            this.searchParamsPhong.ngayNhanPhong = this.hoaDon.ThoiGianNhanPhong;\n            PhongApi.search(this.searchParamsPhong).then(res => {\n                this.getGiaApDung();\n                this.dsPhong = res.Data;\n            });\n        },\n        getDSLoaiPhong(): void {\n            LoaiPhongApi.search(this.searchParamsLoaiPhong).then(res => {\n                this.dsLoaiPhong = res.Data;\n            });\n        },\n        getDSDichVu(): void {\n            DichVuApi.search(this.searchParamsDichVu).then(res => {\n                this.dsDichVu = res.Data;\n            });\n        },\n        getDichVu(): void {\n            DichVuApi.detail(this.datDichVu.DichVuID).then(res => {\n                this.dichVu = res;\n            });\n        },\n        getGiaApDung(): void {\n            var thoigian = this.$moment(this.hoaDon.ThoiGianNhanPhong).format(\"DD/MM/YYYY\");\n            if (this.searchParamsPhong.loaiPhongID != null && this.searchParamsPhong.loaiPhongID != undefined) {\n                BangGiaApi.giaapdung(thoigian,\n                    this.searchParamsPhong.loaiPhongID as any).then(res => {\n                        this.bangGia = res\n                    })\n            }\n        },\n        getDSThuePhong() {\n            this.searchParamsThuePhong.hoaDonID = this.hoaDon.HoaDonID;\n            ThuePhongApi.search(this.searchParamsThuePhong).then(res => {\n                this.dsThuePhong = res.Data;\n            })\n        },\n        getDSDatDichVu() {\n            this.searchParamsDatDichVu.hoaDonID = this.hoaDon.HoaDonID;\n            DatDichVuApi.search(this.searchParamsDatDichVu).then(res => {\n                this.dsDatDichVu = res.Data;\n            })\n        },\n        themSuaThuePhong(isUpdate: boolean, item: any) {\n            this.thuePhong.BangGiaID = this.bangGia.BangGiaID;\n            this.thuePhong.HoaDonID = this.hoaDon.HoaDonID;\n            if (isUpdate == true) {\n\n            }\n            else {\n                ThuePhongApi.insert(this.thuePhong).then(res => {\n                    this.thuePhong = {} as ThuePhong;\n                    this.searchParamsPhong.loaiPhongID = null as any;\n                    this.getDSThuePhong();\n                });\n            }\n        },\n        themSuaDatDichVu(isUpdate: boolean, item: any) {\n            this.datDichVu.HoaDonID = this.hoaDon.HoaDonID;\n            if (isUpdate == true) {\n                DatDichVuApi.detail(item.DatDichVuID).then(res => {\n                    this.datDichVu = res;\n                    this.isUpdateDichVu = true;\n                });\n            }\n            else {\n                if (this.isUpdateDichVu == true) {\n                    DatDichVuApi.update(this.datDichVu.DatDichVuID, this.datDichVu).then(res => {\n                        this.datDichVu = {} as DatDichVu;\n                        this.isUpdateDichVu = false;\n                        this.getDSDatDichVu();\n                        this.$snotify.success('Cập nhật thành công!');\n                    }).catch(res => {\n                        this.loading = false;\n                        this.$snotify.error('Cập nhật thất bại!');\n                    });\n                }\n                else {\n                    DatDichVuApi.insert(this.datDichVu).then(res => {\n                        this.datDichVu = {} as DatDichVu;\n                        this.isUpdateDichVu = false;\n                        this.getDSDatDichVu();\n                    });\n                }\n\n            }\n        },\n        confirmDelete(item1: ThuePhong, item2: DatDichVu): void {\n            this.selectedThuePhong = item1;\n            this.selectedDatDichVu = item2;\n            this.dialogConfirmDelete = true;\n        },\n        deleteChiTietHoaDon(): void {\n            if (this.selectedDatDichVu != null) {\n                DatDichVuApi.delete(this.selectedDatDichVu.DatDichVuID).then(res => {\n                    this.$snotify.success('Xóa thành công!');\n                    this.getDSDatDichVu();\n                    this.dialogConfirmDelete = false;\n                }).catch(res => {\n                    this.$snotify.error('Xóa thất bại!');\n                });\n            }\n            if (this.selectedThuePhong != null) {\n                ThuePhongApi.delete(this.selectedThuePhong.ThuePhongID).then(res => {\n                    this.$snotify.success('Xóa thành công!');\n                    this.getDSThuePhong();\n                    this.dialogConfirmDelete = false;\n                }).catch(res => {\n                    this.$snotify.error('Xóa thất bại!');\n                });\n            }\n        },\n        save(): void {\n            this.$validator.validateAll('frmAddEdit').then((res) => {\n                if (res) {\n                    this.hoaDon.DatPhong = undefined;\n                    this.hoaDon.NhanVien = undefined;\n                    this.hoaDon.KhachHang = undefined;\n                    this.hoaDon.DatDichVu = undefined;\n                    this.hoaDon.ThuePhong = undefined;\n                    if (this.isUpdate) {\n                        this.loading = true;\n                        HoaDonApi.update(this.hoaDon.HoaDonID, this.hoaDon).then(res => {\n                            this.loading = false;\n                            this.dialog = false;\n                            this.$emit(\"getLaiDanhSach\");\n                            this.$snotify.success('Cập nhật thành công!');\n                        }).catch(res => {\n                            this.loading = false;\n                            this.$snotify.error('Cập nhật thất bại!');\n                        });\n                    } else {\n                        this.loading = true;\n                        this.hoaDon.KhachHangID = this.khachHang.KhachHangID;\n                        this.hoaDon.NhanVienID = store.state.user.Profile.NhanVien.NhanVienID;\n                        HoaDonApi.insert(this.hoaDon).then(res => {\n                            this.hoaDon = res;\n                            this.isUpdate = true;\n                            this.loading = false;\n                            this.$emit(\"getLaiDanhSach\");\n                            this.$snotify.success('Thêm mới thành công!');\n                        }).catch(res => {\n                            this.loading = false;\n                            this.$snotify.error('Thêm mới thất bại!');\n                        });\n                    }\n                }\n            });\n        },\n    }\n});\n"],"sourceRoot":""}]}