{"remainingRequest":"C:\\Users\\Trang\\Desktop\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Trang\\Desktop\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\src\\components\\KiemKe\\ThemSuaKiemKe.vue?vue&type=script&lang=ts&","dependencies":[{"path":"C:\\Users\\Trang\\Desktop\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\src\\components\\KiemKe\\ThemSuaKiemKe.vue","mtime":1603956408982},{"path":"C:\\Users\\Trang\\Desktop\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1603956549663},{"path":"C:\\Users\\Trang\\Desktop\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Trang\\Desktop\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\Trang\\Desktop\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1603956549663},{"path":"C:\\Users\\Trang\\Desktop\\My My hihi\\Trên lớp\\CNLTTH_LTTH\\QuanLyKhachSan\\QuanLyKhachSanCli\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Vue } from 'vue-property-decorator';\nimport KiemKeApi, { KiemKeApiSearchParams } from '@/apiResources/KiemKeApi';\nimport { KiemKe } from '@/models/KiemKe';\nimport { ChiTietKiemKe } from '@/models/ChiTietKiemKe';\nimport ChiTietKiemKeApi, { ChiTietKiemKeApiSearchParams } from '@/apiResources/ChiTietKiemKeApi';\nimport ModalChiTietKiemKe from './ModalChiTietKiemKe.vue'\nexport default Vue.extend({\n    $_veeValidate: {\n        validator: 'new'\n    },\n    components: {\n        ModalChiTietKiemKe\n    },\n    data() {\n        return {\n            dialog: false,\n            isUpdate: false,\n            kiemKe: {} as KiemKe,\n            dsChiTietKiemKe: [] as ChiTietKiemKe[],\n            chiTietKiemKe: {} as ChiTietKiemKe,\n            dsChiTietKiemKeLoading: false,\n            searchChiTietKiemKe: '',\n            searchParamsChiTietKiemKe: { includeEntities: true } as ChiTietKiemKeApiSearchParams,\n            tableHeaderChiTietKiemKe: [\n                { text: '#', value: 'ChiTietKiemKeID', align: 'center', sortable: true },\n                { text: 'Tên vật dụng', value: 'VatDungPhongID', align: 'center', sortable: true },\n                { text: 'Số lượng tiêu chuẩn', value: 'VatDungPhongID', align: 'center', sortable: true },\n                { text: 'Số lượng kiểm kê', value: 'SoLuongKiemKe', align: 'center', sortable: true },\n                { text: 'Chênh lệch', value: 'GhiChu', align: 'center', sortable: true },\n                { text: 'Số lượng kho', value: 'GhiChu', align: 'center', sortable: true },\n            ],\n            loading: false,\n            searchParamsKiemKe: {} as KiemKeApiSearchParams,\n        }\n    },\n    watch: {\n    },\n    methods: {\n        show(isUpdate: boolean, item: any) {\n            this.dialog = true;\n            this.$validator.errors.clear(\"frmAddEdit\");\n            this.isUpdate = isUpdate;\n            this.dsChiTietKiemKe = [] as ChiTietKiemKe[];\n            if (this.isUpdate !== true) {\n                this.kiemKe = {} as KiemKe;\n            }\n            else {\n                this.getDataFromApi(item.KiemKeID);\n            }\n        },\n        showModalChiTietKiemKe() {\n            (this.$refs.modalChiTietKiemKe as any).show(this.kiemKe.KiemKeID)\n        },\n        getDataFromApi(id: number): void {\n            KiemKeApi.detail(id).then(res => {\n                this.kiemKe = res;\n                this.searchParamsChiTietKiemKe.kiemKeID = res.KiemKeID;\n                this.getDSChiTietKiemKe();\n            });\n        },\n        save(): void {\n            this.$validator.validateAll('frmAddEdit').then((res) => {\n               if (res) {\n                    this.kiemKe.NhanVien = undefined;\n                    this.kiemKe.ChiTietKiemKe = undefined;\n                    if (this.isUpdate) {\n                        this.loading = true;\n                        KiemKeApi.update(this.kiemKe.KiemKeID, this.kiemKe).then(res => {\n                            this.loading = false;\n                            this.dialog = false;\n                            this.$emit(\"getLaiDanhSach\");\n                            this.$snotify.success('Cập nhật thành công!');\n                        }).catch(res => {\n                            this.loading = false;\n                            this.$snotify.error('Cập nhật thất bại!');\n                        });\n                    } else {\n                        this.loading = true;\n                        KiemKeApi.insert(this.kiemKe).then(res => {\n                            this.kiemKe = res;\n                            this.searchParamsChiTietKiemKe.kiemKeID = res.KiemKeID;\n                            this.getDSChiTietKiemKe();\n                            this.$emit(\"getLaiDanhSach\");\n                            this.isUpdate = true;\n                            this.loading = false;\n                            this.$snotify.success('Thêm mới thành công!');\n                        }).catch(res => {\n                            this.loading = false;\n                            this.$snotify.error('Thêm mới thất bại!');\n                        });\n                    }\n                }\n            });\n        },\n        getDSChiTietKiemKe(): void {\n            ChiTietKiemKeApi.search(this.searchParamsChiTietKiemKe).then(res => {\n                this.dsChiTietKiemKe = res.Data;\n            });\n        },\n       \n    }\n});\n",{"version":3,"sources":["ThemSuaKiemKe.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"ThemSuaKiemKe.vue","sourceRoot":"src\\components\\KiemKe","sourcesContent":["<template>\r\n    <v-dialog v-model=\"dialog\" width=\"800\" persistent scrollable>\r\n        <v-container pa-0 grid-list-md>\r\n            <v-card>\r\n                <v-card-title class=\"primary white--text\" style=\"padding: 5px 15px 5px 15px\">\r\n                    <h3>{{isUpdate ? 'Cập nhật kiểm kê' : 'Thêm mới kiểm kê'}}</h3>\r\n                    <v-spacer></v-spacer>\r\n                    <v-btn class=\"white--text ma-0\" small @click.native=\"dialog = false\" icon dark><v-icon>close</v-icon></v-btn>\r\n                </v-card-title>\r\n                <v-card-text>\r\n                    <v-form scope=\"frmAddEdit\">\r\n                        <v-layout row wrap>\r\n                            <v-flex xs6>\r\n                                <v-text-field v-model=\"kiemKe.MaKiemKe\"\r\n                                              label=\"Mã kiểm kê\"\r\n                                              type=\"text\" disabled\r\n                                              :error-messages=\"errors.collect('Mã kiểm kê', 'frmAddEdit')\"\r\n                                              v-validate=\"''\"\r\n                                              data-vv-scope=\"frmAddEdit\"\r\n                                              data-vv-name=\"Mã kiểm kê\"\r\n                                              hide-details\r\n                                              clearable></v-text-field>\r\n                            </v-flex>\r\n                            <v-flex xs6>\r\n                                <v-datepicker v-model=\"kiemKe.NgayKiemKe\"\r\n                                              label=\"Ngày kiểm kê\"\r\n                                              :error-messages=\"errors.collect('Ngày kiểm kê', 'frmAddEdit')\"\r\n                                              v-validate=\"''\"\r\n                                              data-vv-scope=\"frmAddEdit\"\r\n                                              data-vv-name=\"Ngày kiểm kê\"\r\n                                              hide-details\r\n                                              clearable></v-datepicker>\r\n                            </v-flex>\r\n                            <v-flex xs12>\r\n                                <v-text-field v-model=\"kiemKe.GhiChu\"\r\n                                              label=\"Ghi chú\"\r\n                                              type=\"text\"\r\n                                              :error-messages=\"errors.collect('Ghi chú', 'frmAddEdit')\"\r\n                                              v-validate=\"''\"\r\n                                              data-vv-scope=\"frmAddEdit\"\r\n                                              data-vv-name=\"Ghi chú\"\r\n                                              clearable></v-text-field>\r\n                            </v-flex>\r\n                            <v-flex xs12>\r\n                                <v-layout nowrap>\r\n                                    <h3>Chi tiết kiểm kê</h3>\r\n                                    <v-spacer></v-spacer>\r\n                                    <v-btn color=\"primary\" v-show=\"isUpdate\" @click=\"showModalChiTietKiemKe()\" small>Cập nhật thông tin kiểm kê</v-btn>\r\n                                </v-layout>\r\n                            </v-flex>\r\n                            <v-flex xs12>\r\n                                <v-data-table :headers=\"tableHeaderChiTietKiemKe\"\r\n                                              :items=\"dsChiTietKiemKe\"\r\n                                              :pagination.sync=\"searchParamsChiTietKiemKe\"\r\n                                              :total-items=\"searchParamsChiTietKiemKe.totalItems\"\r\n                                              class=\"table-border table\">\r\n                                    <template slot=\"items\" slot-scope=\"props\">\r\n                                        <td>{{ props.index + 1 }}</td>\r\n                                        <td>{{ props.item.TenVatDung}}</td>\r\n                                        <td>{{ props.item.SoLuongTieuChuan }}</td>\r\n                                        <td>{{ props.item.SoLuongKiemKe }}</td>\r\n                                        <td>{{ props.item.SoLuongTieuChuan - props.item.SoLuongKiemKe }}</td>\r\n                                        <td>{{ props.item.SoLuongKho }}</td>\r\n                                    </template>\r\n                                </v-data-table>\r\n                            </v-flex>\r\n                        </v-layout>\r\n                    </v-form>\r\n                </v-card-text>\r\n                <v-card-actions>\r\n                    <v-spacer></v-spacer>\r\n                    <v-btn class=\"primary\" :disabled=\"loading\" :loading=\"loading\" @click.native=\"save\">{{isUpdate?'Cập nhật':'Thêm mới'}}</v-btn>\r\n                </v-card-actions>\r\n                <modal-chi-tiet-kiem-ke ref=\"modalChiTietKiemKe\" @getLaiKiemKe=\"getDSChiTietKiemKe()\"></modal-chi-tiet-kiem-ke>\r\n            </v-card>\r\n        </v-container>\r\n    </v-dialog>\r\n</template>\r\n<script lang=\"ts\">\r\n    import { Vue } from 'vue-property-decorator';\r\n    import KiemKeApi, { KiemKeApiSearchParams } from '@/apiResources/KiemKeApi';\r\n    import { KiemKe } from '@/models/KiemKe';\r\n    import { ChiTietKiemKe } from '@/models/ChiTietKiemKe';\r\n    import ChiTietKiemKeApi, { ChiTietKiemKeApiSearchParams } from '@/apiResources/ChiTietKiemKeApi';\r\n    import ModalChiTietKiemKe from './ModalChiTietKiemKe.vue'\r\n    export default Vue.extend({\r\n        $_veeValidate: {\r\n            validator: 'new'\r\n        },\r\n        components: {\r\n            ModalChiTietKiemKe\r\n        },\r\n        data() {\r\n            return {\r\n                dialog: false,\r\n                isUpdate: false,\r\n                kiemKe: {} as KiemKe,\r\n                dsChiTietKiemKe: [] as ChiTietKiemKe[],\r\n                chiTietKiemKe: {} as ChiTietKiemKe,\r\n                dsChiTietKiemKeLoading: false,\r\n                searchChiTietKiemKe: '',\r\n                searchParamsChiTietKiemKe: { includeEntities: true } as ChiTietKiemKeApiSearchParams,\r\n                tableHeaderChiTietKiemKe: [\r\n                    { text: '#', value: 'ChiTietKiemKeID', align: 'center', sortable: true },\r\n                    { text: 'Tên vật dụng', value: 'VatDungPhongID', align: 'center', sortable: true },\r\n                    { text: 'Số lượng tiêu chuẩn', value: 'VatDungPhongID', align: 'center', sortable: true },\r\n                    { text: 'Số lượng kiểm kê', value: 'SoLuongKiemKe', align: 'center', sortable: true },\r\n                    { text: 'Chênh lệch', value: 'GhiChu', align: 'center', sortable: true },\r\n                    { text: 'Số lượng kho', value: 'GhiChu', align: 'center', sortable: true },\r\n                ],\r\n                loading: false,\r\n                searchParamsKiemKe: {} as KiemKeApiSearchParams,\r\n            }\r\n        },\r\n        watch: {\r\n        },\r\n        methods: {\r\n            show(isUpdate: boolean, item: any) {\r\n                this.dialog = true;\r\n                this.$validator.errors.clear(\"frmAddEdit\");\r\n                this.isUpdate = isUpdate;\r\n                this.dsChiTietKiemKe = [] as ChiTietKiemKe[];\r\n                if (this.isUpdate !== true) {\r\n                    this.kiemKe = {} as KiemKe;\r\n                }\r\n                else {\r\n                    this.getDataFromApi(item.KiemKeID);\r\n                }\r\n            },\r\n            showModalChiTietKiemKe() {\r\n                (this.$refs.modalChiTietKiemKe as any).show(this.kiemKe.KiemKeID)\r\n            },\r\n            getDataFromApi(id: number): void {\r\n                KiemKeApi.detail(id).then(res => {\r\n                    this.kiemKe = res;\r\n                    this.searchParamsChiTietKiemKe.kiemKeID = res.KiemKeID;\r\n                    this.getDSChiTietKiemKe();\r\n                });\r\n            },\r\n            save(): void {\r\n                this.$validator.validateAll('frmAddEdit').then((res) => {\r\n                   if (res) {\r\n                        this.kiemKe.NhanVien = undefined;\r\n                        this.kiemKe.ChiTietKiemKe = undefined;\r\n                        if (this.isUpdate) {\r\n                            this.loading = true;\r\n                            KiemKeApi.update(this.kiemKe.KiemKeID, this.kiemKe).then(res => {\r\n                                this.loading = false;\r\n                                this.dialog = false;\r\n                                this.$emit(\"getLaiDanhSach\");\r\n                                this.$snotify.success('Cập nhật thành công!');\r\n                            }).catch(res => {\r\n                                this.loading = false;\r\n                                this.$snotify.error('Cập nhật thất bại!');\r\n                            });\r\n                        } else {\r\n                            this.loading = true;\r\n                            KiemKeApi.insert(this.kiemKe).then(res => {\r\n                                this.kiemKe = res;\r\n                                this.searchParamsChiTietKiemKe.kiemKeID = res.KiemKeID;\r\n                                this.getDSChiTietKiemKe();\r\n                                this.$emit(\"getLaiDanhSach\");\r\n                                this.isUpdate = true;\r\n                                this.loading = false;\r\n                                this.$snotify.success('Thêm mới thành công!');\r\n                            }).catch(res => {\r\n                                this.loading = false;\r\n                                this.$snotify.error('Thêm mới thất bại!');\r\n                            });\r\n                        }\r\n                    }\r\n                });\r\n            },\r\n            getDSChiTietKiemKe(): void {\r\n                ChiTietKiemKeApi.search(this.searchParamsChiTietKiemKe).then(res => {\r\n                    this.dsChiTietKiemKe = res.Data;\r\n                });\r\n            },\r\n           \r\n        }\r\n    });\r\n</script>\r\n\r\n"]}]}